{% extends "base2.html" %}
{% load static %}
{% block title %}Profile{% endblock title %}
{% block content %}

<style>
    .profile-container {
        padding: 30px;
        border-radius: 10px;
        width: 70%;
        margin: 50px auto;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
    }
    .profile-header {
        text-align: center;
        margin-bottom: 20px;
    }
    .profile-header img {
        width: 150px;
        height: 150px;
        border-radius: 50%;
        object-fit: cover;
        margin-bottom: 10px;
        border: 2px solid;
    }
    .profile-form {
        display: flex;
        flex-direction: column;
    }
    .form-fields {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
    }
    .form-fields input {
        width: 100%;
        padding: 12px;
        border-radius: 5px;
        border: none;
        color: black;
        border: 0.3px solid;
    }
    .form-fields input[disabled] {
        background-color: #e6e6fb;
        border: 0px;
    }
    .col-12.position-relative {
        grid-column: span 2;
        position: relative;
    }
    .button-group {
        grid-column: span 2;
        display: flex;
        justify-content: space-between;
        margin-top: 20px;
    }
    .button-group button {
        padding: 12px 20px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }
    .edit-btn { background-color: rgb(247, 71, 128); color: white; }
    .save-btn { background-color: #28a745; color: white; }
    .cancel-btn { background-color: #dc3545; color: white; }
</style>

<!-- Header Start -->
<div class="container-fluid bg-breadcrumb">
    <ul class="breadcrumb-animation">
        <li></li><li></li><li></li><li></li><li></li>
        <li></li><li></li><li></li><li></li><li></li>
    </ul>
    <div class="container text-center py-5" style="max-width: 900px;">
        <h3 class="display-3 mb-4 wow fadeInDown" data-wow-delay="0.1s">Profile</h3>
        <ol class="breadcrumb justify-content-center mb-0 wow fadeInDown" data-wow-delay="0.3s">
            <li class="breadcrumb-item"><a href="{% url "user_dashboard" %}">User</a></li>
            <li class="breadcrumb-item active text-primary">Profile</li>
        </ol>    
    </div>
</div>
<!-- Header End -->

<div class="p-4">
    <section class="contact spad">
        <div class="profile-container">
            <form class="profile-form" enctype="multipart/form-data" method="post">
                {% csrf_token %}
                <div class="profile-header">
                    <img id="profileImage" src="{{ i.user_image.url }}" alt="User Profile Image">
                    <input type="file" name="profilepic" id="imageUpload" accept="image/*" style="display: none;">
                    <div class="d-flex justify-content-center">
                        <button type="button" id="edit-btn" class="edit-btn border-0 py-2 px-4" style="display: none; border-radius: 4px;" onclick="document.getElementById('imageUpload').click();">Change Image</button>
                    </div>
                </div>

                <div class="form-fields">
                    <div>
                        <p>Name</p>
                        <input type="text" id="userName" name="username" value="{{ i.user_name }}" disabled>
                    </div>
                    <div>
                        <p>Email</p>
                        <input type="email" id="userEmail" name="email" value="{{ i.user_email }}" disabled>
                    </div>
                    <div>
                        <p>Age</p>
                        <input type="number" id="userAge" name="age" value="{{ i.user_age }}" disabled>
                    </div>
                    <div>
                        <p>Address</p>
                        <input type="text" id="userAddress" name="address" value="{{ i.user_address }}" disabled>
                    </div>
                    <div>
                        <p>Phone no.</p>
                        <input type="text" id="userContact" name="mobile_number" value="{{ i.user_contact }}" disabled>
                    </div>
                    <div class="position-relative">
                        <p>Password</p>
                        <div class="form-floating">
                            <input type="password" id="userPassword" name="password" value="{{ i.user_password }}" disabled>
                            <button type="button" id="togglePassword" class="btn btn-sm position-absolute" style="color: white; top: 55%; right: 10px; transform: translateY(-50%); display: none;"> Show</button>
                        </div>
                    </div>
                    <div class="button-group d-flex justify-content-center">
                        <button type="button" id="editBtn" class="edit-btn" onclick="enableEditing()">Edit Info</button>
                        <div id="actionBtns" style="display: none; gap: 10px;">
                            <button type="submit" class="save-btn">Save Changes</button>
                            <button type="button" class="cancel-btn" onclick="cancelEditing()">Cancel</button>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </section>
</div>

        


    <script>
        const form = document.querySelector('.profile-form');
        const inputs = form.querySelectorAll('input[type="text"], input[type="email"], input[type="number"], input[type="password"]');
        const editBtn = document.getElementById('editBtn');
        const actionBtns = document.getElementById('actionBtns');
        const profileImage = document.getElementById('profileImage');
        const imageUpload = document.getElementById('imageUpload');
        const imageEdit=document.getElementById('edit-btn')
        let originalValues = {};
        const showbtn=document.getElementById("togglePassword")

        function enableEditing() {
            inputs.forEach(input => {
                input.disabled = false;
                originalValues[input.id] = input.value;
            });
            editBtn.style.display = 'none';
            imageEdit.style.display='block';
            actionBtns.style.display = 'flex';
            showbtn.style.display= 'block';
            showbtn.addEventListener("click", function () {
                var passwordField = document.getElementById("userPassword");
                if (passwordField.type === "password") {
                  passwordField.type = "text";
                  this.textContent = "Hide";
                } else {
                  passwordField.type = "password";
                  this.textContent = "Show";
                }
              });
        }

        function cancelEditing() {
            inputs.forEach(input => {
                input.value = originalValues[input.id];
                input.disabled = true;
            });
            editBtn.style.display = 'block';
            actionBtns.style.display = 'none';
            imageEdit.style.display = 'none';
            showbtn.style.display= 'none';
        }

        imageUpload.addEventListener('change', function() {
            const file = this.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    profileImage.src = e.target.result;
                }
                reader.readAsDataURL(file);
            }
        });
        
    </script>
{% endblock content%}